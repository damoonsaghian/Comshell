
  <!DOCTYPE html>
  <html>
  <head>
  <meta charset='utf-8'>
  <title>Comshell</title>
  
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/hack-font/build/web/hack.css'>
  <style>
    body {
      padding: 50px;
      margin: 0;
      font-family: Hack;
      font-size: 14px;
      max-width: 750px;
      white-space: pre-wrap;
    }
    div {
      margin-left: 14px;
      text-indent: -14px;
    }
  </style>
  </head><body><h1>Comshell</h1>
<h2>1, Comshell</h2><div>Comshell is a command based user interface, to be developed in Frem programing language (a functional reactive language using move semantics, based on Rust).</div><div><a href='https://github.com/damoonsaghian/Frem'>https://github.com/damoonsaghian/Frem</a></div><div><p></p></div><div>command based user interfaces (using keyboard, voice, gesture) are faster, more convenient and more powerful than pointing based user interfaces (using mouse, touch, pen).</div><div>touch interfaces can still be useful in simple limited applications. and for some special artistic applications, pen input remains the only choice.</div><div>command based interactions are much simpler for a speech recognition engine to process, since it needs to match against a relatively small set of commands, unlike a general speech recognition process.</div><div>a headset with near range microphone can be used, to exclude far away sound sources. also it is better to put battery and bluetooth of the headset in a separate unit, that can be put in the pocket. this makes the headset lighter and safer.</div><div>for those that neither can use all their fingers, nor can talk, gesture based (2d) input can be implemented.</div><div><p></p></div><div><img src='keyboard.png' alt='keyboard.png'/></div><div>missing characters can be entered using snippets:</div><div>, two commas --&gt; .</div><div>, comma followed by ' --&gt; "</div><div>, comma followed by ( --&gt; [</div><div>, comma followed by add followed by comma --&gt; +</div><div>, comma followed by add followed by space --&gt; + followed by space</div><div>, comma followed by psi followed by space --&gt; Ïˆ followed by space</div><div>, two apostrophes followed by a --&gt; A</div><div>Kinesis Advantage 2 keyboard</div><div><p></p></div><div>Vim'like key'bindings</div><div>modes (like normal mode and insert mode) must be visually distinctive.</div><div>press "esc" to go back to normal mode.</div><div>in normal mode:</div><div>, create a new project or file</div><div>, show list of projects or files, move between files (previous, next), and then press space to open or raise them, or directly go to them by entering their number</div><div>, move the cursor to the next or previous (or by entering the number directly to) words, lines (or table cells), paragraphs</div><div>, start and end selection, then copy or cut</div><div>, paste</div><div>, undo, redo</div><div>, find</div><div>, enter insert mode</div><div><p></p></div><div>projects are looked for in "~/projects/" and all directories named "projects" on all disks. from this list, we can open projects (or switch to them if they are already open).</div><div><p></p></div><div>a panel at the left shows a tree view of the files in the project.</div><div>text files are opened in a text editor panel at the right.</div><div>directories with ".m" extension are opened in a panel at the right, showing thumbnails of the files in it.</div><div><p></p></div><div>focus paragraph, i'e auto scroll to reveal whole paragraph.</div>
<h2>2, graphics</h2><div>software rendering gives us a lot more flexibility, since we are not any more limited by a hardware implementation with triangle only rasterization, isolated shader programs, and fixed size buffers.</div><div><p></p></div><div>font-rs</div><div><a href='https://github.com/google/font-rs'>https://github.com/google/font-rs</a></div><div><a href='https://docs.rs/rusterize/'>https://docs.rs/rusterize/</a></div><div><a href='https://docs.rs/softrender/'>https://docs.rs/softrender/</a></div><div><a href='https://crates.io/crates/line_drawing'>https://crates.io/crates/line_drawing</a></div><div><a href='https://www.siggraph.org/education/materials/HyperGraph/scanline/outprims/drawline.htm'>https://www.siggraph.org/education/materials/HyperGraph/scanline/outprims/drawline.htm</a></div><div><a href='https://en.wikipedia.org/wiki/Bresenham's_line_algorithm'>https://en.wikipedia.org/wiki/Bresenham's_line_algorithm</a></div><div><a href='https://en.wikipedia.org/wiki/Midpoint_circle_algorithm'>https://en.wikipedia.org/wiki/Midpoint_circle_algorithm</a></div><div><a href='https://en.wikipedia.org/wiki/Xiaolin_Wu%27s_line_algorithm'>https://en.wikipedia.org/wiki/Xiaolin_Wu%27s_line_algorithm</a></div><div><a href='http://members.chello.at/~easyfilter/bresenham.html'>http://members.chello.at/~easyfilter/bresenham.html</a></div><div><a href='https://nothings.org/gamedev/rasterize/'>https://nothings.org/gamedev/rasterize/</a></div><div><a href='https://magcius.github.io/xplain/article/'>https://magcius.github.io/xplain/article/</a></div><div><p></p></div><div>graphical objects are made of primitives. primitives are defined using a set of</div><div>parameters. each primitive has a specific algorithm for rasterization.</div><div>2d primitives: point, line, curve, triangle, curved area.</div><div>3d objects made of flat surfaces will be broken up into triangles.</div><div>3d objects made of curved surfaces can be broken up into a number of primitive 3d surfaces which can be easily projected to 2d.</div><div><a href='https://en.wikipedia.org/wiki/Quadric'>https://en.wikipedia.org/wiki/Quadric</a></div><div>also interpolation is a good method for amorphous surfaces.</div><div><p></p></div><div>2d objects will be rasterized into pixels (a pixel is a coordinate plus a color value).</div><div>then these rasterized objects will be drawn in the framebuffer, in layers over each other (in an overlay on top of all 3d objects).</div><div>rasterizing 3d objects, produces an array of fragments. a fragment, besides color, contains a normal and a depth.</div><div>when creating the pixels of the framebuffer from the fragments, the normals are used for lighting, and the depths are used for z'buffer.</div><div><p></p></div><div><a href='https://en.wikipedia.org/wiki/Stencil_buffer'>https://en.wikipedia.org/wiki/Stencil_buffer</a></div><div><a href='https://www.scratchapixel.com'>https://www.scratchapixel.com</a></div><div><a href='https://www.scratchapixel.com/lessons/3d-basic-rendering/phong-shader-BRDF'>https://www.scratchapixel.com/lessons/3d-basic-rendering/phong-shader-BRDF</a></div><div><p></p></div><div>graphical objects are of 2 kinds:</div><div>, those which we know will remain unchanged the next time we want to draw to the framebuffer. these objects are first rasterized into memory, then we copy it into framebuffer.</div><div>, those which we know will be changed (scaled, rotated, moved in z direction) the next time we want to draw to the framebuffer (which happens a lot for animations with high frame rate). these objects will be drawn directly to the framebuffer.</div><div>(framebuffer uses double buffering and v'sync)</div><div>note that if an object just moves in x'y plane (without rotation), the cached rasterization is still useful. for 2d objects we simply add a constant to the position of all pixels. for 3d objects we may additionally want to recompute the lighting of pixels from fragments.</div><div><p></p></div><div>graphical objects:</div><div>, primitives</div><div>, material</div><div>, cached rasterization (can be none)</div><div><p></p></div><div>graphical objects can be put in a layout tree. transformations on objects will be applied in groups, based on the tree.</div><div>objects are moved to the tree. they can be accessed only internally. it means that, unlike in a scene'graph, pointers to objects in the tree are not accessible globally. so there are no free pointers, and no need for run'time memory management.</div>
<h2>3, useful libs</h2><div>winit</div><div>evdev (for input) and drm (to access the framebuffer)</div><div><p></p></div><div>text editing:</div><div><a href='https://github.com/jmacdonald/scribe'>https://github.com/jmacdonald/scribe</a></div><div><a href='https://github.com/mathall/rim'>https://github.com/mathall/rim</a></div><div><a href='https://github.com/gchp/iota'>https://github.com/gchp/iota</a></div><div><p></p></div><div>web:</div><div><a href='https://github.com/servo/rust-url/'>https://github.com/servo/rust-url/</a></div><div><a href='https://crates.io/crates/hyper'>https://crates.io/crates/hyper</a></div><div>  <a href='https://crates.io/crates/hyper-rustls'>https://crates.io/crates/hyper-rustls</a></div><div>  <a href='https://crates.io/crates/reqwest'>https://crates.io/crates/reqwest</a></div><div>  <a href='https://crates.io/crates/simplist'>https://crates.io/crates/simplist</a></div><div><a href='https://crates.io/crates/httpbin'>https://crates.io/crates/httpbin</a></div><div><a href='https://crates.io/crates/httpbis'>https://crates.io/crates/httpbis</a></div><div><a href='https://crates.io/crates/xmpp-proto'>https://crates.io/crates/xmpp-proto</a></div><div><a href='https://crates.io/crates/pijul'>https://crates.io/crates/pijul</a> (version control system)</div><div><p></p></div><div>media:</div><div><a href='https://github.com/pcwalton/rust-media'>https://github.com/pcwalton/rust-media</a></div><div><a href='https://github.com/meh/rust-ffmpeg'>https://github.com/meh/rust-ffmpeg</a></div><div><a href='https://crates.io/crates/mpv'>https://crates.io/crates/mpv</a></div><div><a href='https://github.com/tomaka/rodio'>https://github.com/tomaka/rodio</a></div><div><a href='https://github.com/tomaka/cpal'>https://github.com/tomaka/cpal</a></div><div><a href='https://crates.io/crates/lewton'>https://crates.io/crates/lewton</a></div><div><a href='https://crates.io/crates/camera_capture'>https://crates.io/crates/camera_capture</a></div>
<h2>4, prototype</h2><div>actually, implementing Comshell is a lot of work. first we must implement Frem language, then a graphics library, then a lot of standard u'i utilities on top of that library.</div><div>but as a demonstration, we can build a prototype, using existing tools.</div><div><p></p></div><div>Arch Linux provides a binary/shared library distribution system, which is very close to the original build process.</div><div><p></p></div><div>boot to an existing Arch Linux (installed or live) then:</div><div>$ timedatectl set-ntp true</div><div>prepare the disk (use lsblk to identify the block devices), and mount it:</div><div>  $ mkfs.btrfs -f /dev/sdx</div><div>  $ mount /dev/sdx /mnt</div><div>  btrfs is used because journaling file systems can only protect metadata, at an acceptable performance. since they need to write all file system operations twice, once to the journal, and once to the file system.</div><div>  copy'on'write provides consistency for both data and metadata.</div><div>  also, it can offer integrity of data and metadata (using checksums), at an acceptable overhead.</div><div>  in addition, c'o'w also supports the creation of cheap snapshots and clones (because it does not overwrite data in place). users can take fast online backups without the need to use any special software technique like l'v'm.</div><div>$ pacstrap /mnt grub sed intel-ucode linux systemd-sysvcompat btrfs-progs dhcpcd pacman nano man-db logrotate sudo alsa-utils noto-fonts ttf-hack sway emacs xdotool mplayer chromium rustup</div><div>$ arch-chroot /mnt</div><div>bootloader:</div><div>  $ grub-install --target=i386-pc /dev/sdx</div><div>  $ grub-mkconfig -o /boot/grub/grub.cfg</div><div>  $ nano boot/grub/grub.cfg</div><div>    set timeout = 0</div><div>$ systemctl enable dhcpcd.service</div><div>create user:</div><div>  $ useradd -m -G wheel user1</div><div>  $ passwd -d user1</div><div>  $ EDITOR=nano visudo</div><div>    %wheel ALL=(ALL) ALL</div><div>$ nano /etc/systemd/system/getty@tty1.service.d/override.conf</div><div>  [Service]</div><div>  ExecStart=</div><div>  ExecStart=-/usr/bin/agetty --autologin user1 --noclear %I $TERM</div><div>$ systemctl enable systemd-timesyncd.service</div><div>$ amixer sset Master unmute</div><div>$ exit; reboot</div><div><p></p></div><div>$ nano ~/.bashrc</div><div>  sway</div><div>$ mkdir -p ~/.config/sway</div><div>$ cp prototype/sway.txt ~/.config/sway/config</div><div><p></p></div><div>$ cp -r emacs/ ~/.emacs.d/</div><div><p></p></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Invocation.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Emacs-Invocation.html</a></div><div><p></p></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Init-File.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Init-File.html</a></div><div><p></p></div><div><a href='http://ergoemacs.org/emacs/file_management.html'>http://ergoemacs.org/emacs/file_management.html</a></div><div><a href='https://github.com/Fuco1/dired-hacks'>https://github.com/Fuco1/dired-hacks</a></div><div><a href='https://emacs.stackexchange.com/questions/12153/does-some-command-exist-which-goes-to-the-next-file-of-the-current-directory'>https://emacs.stackexchange.com/questions/12153/does-some-command-exist-which-goes-to-the-next-file-of-the-current-directory</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Files.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Files.html</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Dired.html</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Commands-in-Dired.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell-Commands-in-Dired.html</a></div><div><a href='https://github.com/thamer/runner'>https://github.com/thamer/runner</a></div><div><p></p></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/elisp/Choosing-Window.html'>https://www.gnu.org/software/emacs/manual/html_node/elisp/Choosing-Window.html</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Change-Window.html</a></div><div>split-window-horizontally</div><div>follow-mode</div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Display.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Display.html</a></div><div><a href='https://github.com/larstvei/Focus'>https://github.com/larstvei/Focus</a></div><div><a href='https://www.emacswiki.org/emacs/HideShow'>https://www.emacswiki.org/emacs/HideShow</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Pages.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Pages.html</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Words.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Words.html</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Hard-and-Soft-Newlines.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Hard-and-Soft-Newlines.html</a></div><div><a href='https://github.com/joostkremers/visual-fill-column'>https://github.com/joostkremers/visual-fill-column</a></div><div><p></p></div><div><a href='https://jblevins.org/projects/markdown-mode/'>https://jblevins.org/projects/markdown-mode/</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Abbrevs.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Abbrevs.html</a></div><div><a href='https://orgmode.org/manual/Tables.html'>https://orgmode.org/manual/Tables.html</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Based-Tables.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Text-Based-Tables.html</a></div><div><p></p></div><div><a href='http://shallowsky.com/blog/linux/editors/graphics-in-emacs.html'>http://shallowsky.com/blog/linux/editors/graphics-in-emacs.html</a></div><div><a href='https://www.gnu.org/software/auctex'>https://www.gnu.org/software/auctex</a></div><div><a href='https://github.com/aaptel/preview-latex'>https://github.com/aaptel/preview-latex</a></div><div><a href='https://github.com/josteink/wsd-mode'>https://github.com/josteink/wsd-mode</a></div><div><a href='http://ergoemacs.org/emacs/emacs_view_image_thumbnails.html'>http://ergoemacs.org/emacs/emacs_view_image_thumbnails.html</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Image_002dDired.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Image_002dDired.html</a></div><div><a href='https://www.emacswiki.org/emacs/ThumbsMode'>https://www.emacswiki.org/emacs/ThumbsMode</a></div><div><a href='https://www.gnu.org/software/emms/screenshots.html'>https://www.gnu.org/software/emms/screenshots.html</a></div><div><a href='http://wikemacs.org/wiki/Media_player'>http://wikemacs.org/wiki/Media_player</a></div><div><a href='https://lars.ingebrigtsen.no/2011/04/12/emacs-movie-browser/'>https://lars.ingebrigtsen.no/2011/04/12/emacs-movie-browser/</a></div><div><a href='https://github.com/larsmagne/movie.el'>https://github.com/larsmagne/movie.el</a></div><div><a href='https://github.com/dbrock/bongo'>https://github.com/dbrock/bongo</a></div><div><a href='http://www.mplayerhq.hu/DOCS/tech/slave.txt'>http://www.mplayerhq.hu/DOCS/tech/slave.txt</a></div><div><p></p></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Hyperlinking.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Hyperlinking.html</a></div><div><a href='https://www.chromium.org/user-experience/multi-profiles'>https://www.chromium.org/user-experience/multi-profiles</a></div><div><p></p></div><div><a href='https://www.emacswiki.org/emacs/CategoryShell'>https://www.emacswiki.org/emacs/CategoryShell</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell.html'>https://www.gnu.org/software/emacs/manual/html_node/emacs/Shell.html</a></div><div><a href='https://www.gnu.org/software/emacs/manual/html_node/eshell/index.html'>https://www.gnu.org/software/emacs/manual/html_node/eshell/index.html</a></div><div><a href='http://ergoemacs.org/emacs/emacs_unix.html'>http://ergoemacs.org/emacs/emacs_unix.html</a></div><div><a href='http://ergoemacs.org/emacs/emacs_magit-mode_tutorial.html'>http://ergoemacs.org/emacs/emacs_magit-mode_tutorial.html</a></div><div><a href='https://magit.vc/'>https://magit.vc/</a></div><div><a href='https://github.com/vermiculus/magithub'>https://github.com/vermiculus/magithub</a></div><div><a href='http://wikemacs.org/wiki/El-get'>http://wikemacs.org/wiki/El-get</a></div><div><p></p></div><div><a href='https://github.com/rust-lang/rust-mode'>https://github.com/rust-lang/rust-mode</a></div><div><a href='https://github.com/kwrooijen/cargo.el'>https://github.com/kwrooijen/cargo.el</a></div><div><a href='https://github.com/racer-rust/emacs-racer'>https://github.com/racer-rust/emacs-racer</a></div><div><a href='https://github.com/flycheck/flycheck-rust'>https://github.com/flycheck/flycheck-rust</a></div>
<h2>url</h2><div><a href='https://github.com/damoonsaghian/Comshell'>https://github.com/damoonsaghian/Comshell</a></div><div>this project is public domain.</div></body></html>